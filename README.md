To do:

-  Accomodate GE tax in total profit.
-  Find elegant way to fix/match averages more accurately. Maybe storing data in db will help to perform more complex algorithms. 
